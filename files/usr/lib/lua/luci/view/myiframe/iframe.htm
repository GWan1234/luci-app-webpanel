<%+header%>

<div class="cbi-map">
    <h2 name="content"><%:Embedded Web Page%></h2>
    
    <div class="cbi-map-descr">
        <%:This page displays an external web page embedded in the OpenWRT interface.%>
    </div>
    
    <fieldset class="cbi-section">
        <%
        local uci = require "luci.model.uci".cursor()
        local url = uci:get("myiframe", "config", "url") or ""
        local width = uci:get("myiframe", "config", "width") or "100%"
        local height = uci:get("myiframe", "config", "height") or "600px"
        local border = uci:get("myiframe", "config", "border") or "1"
        local refresh = tonumber(uci:get("myiframe", "config", "refresh") or "0")
        
        local style = string.format("width: %s; height: %s; border: %s;", 
            width, height, border == "1" and "1px solid #ccc" or "none")
        %>
        
        <iframe id="embedded-page" src="<%=url%>" style="<%=style%>"></iframe>
        
        <% if refresh > 0 then %>
        <script type="text/javascript">
            setInterval(function() {
                document.getElementById('embedded-page').src = document.getElementById('embedded-page').src;
            }, <%=refresh * 1000%>);
        </script>
        <% end %>
    </fieldset>
    
    <div class="cbi-page-actions">
        <form class="inline" action="<%=url('admin/services/myiframe/config')%>">
            <input class="cbi-button cbi-button-apply" type="submit" value="<%:Edit Settings%>"/>
        </form>
    </div>
</div>

<%+footer%>
